<!DOCTYPE html>
<html lang="th" id="app-html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🦅 Ultimate AI Bird Intelligence System V2.0 - Swallow AI</title>
    
    <!-- Enhanced Meta Tags -->
    <meta name="description" content="Advanced AI-powered bird monitoring system with real-time detection, analytics, and intelligent alerts">
    <meta name="keywords" content="AI, Bird Detection, Smart System, YOLOv4, Computer Vision, Real-time Monitoring">
    <meta name="author" content="Swallow AI Team">
    <meta name="theme-color" content="#00D4FF">
    <meta name="robots" content="index, follow">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'neon-blue': '#00D4FF',
                        'neon-purple': '#8B5CF6', 
                        'neon-pink': '#F472B6',
                        'neon-green': '#10B981',
                        'neon-orange': '#F59E0B',
                        'neon-red': '#EF4444',
                        'cyber-dark': '#0F0F23',
                        'cyber-light': '#1A1A40',
                        'cyber-medium': '#2D1B69',
                        'ai-primary': '#4338CA',
                        'ai-secondary': '#7C3AED',
                        'ai-accent': '#06B6D4'
                    },
                    fontFamily: {
                        'kanit': ['Kanit', 'sans-serif'],
                        'orbitron': ['Orbitron', 'monospace'],
                        'inter': ['Inter', 'sans-serif']
                    },
                    animation: {
                        'scale-pulse': 'scalePulse 2s ease-in-out infinite',
                        'neon-glow': 'neonGlow 3s ease-in-out infinite alternate',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'bounce-soft': 'bounceSoft 2s ease-in-out infinite'
                    },
                    backdropBlur: {
                        '4xl': '72px'
                    },
                    boxShadow: {
                        'neon': '0 0 20px rgba(0, 212, 255, 0.5)',
                        'glass': '0 8px 32px rgba(0, 0, 0, 0.3)'
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200;300;400;500;600;700;800&family=Orbitron:wght@400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <style>
        /* ===== ULTRA MODERN CSS VARIABLES ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --neon-gradient: linear-gradient(135deg, #00D4FF 0%, #8B5CF6 50%, #F472B6 100%);
            --ai-gradient: linear-gradient(135deg, #4338CA 0%, #7C3AED 100%);
            --glass-light: rgba(255, 255, 255, 0.1);
            --glass-dark: rgba(0, 0, 0, 0.2);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-neon: 0 0 30px rgba(0, 212, 255, 0.4);
            --shadow-purple: 0 0 30px rgba(139, 92, 246, 0.4);
            --shadow-pink: 0 0 30px rgba(244, 114, 182, 0.4);
            --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.3);
            --border-radius: 20px;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===== GLOBAL STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Kanit', sans-serif;
            background: linear-gradient(135deg, #0F0F23 0%, #1A1A40 30%, #2D1B69 70%, #4338CA 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* ===== ANIMATED BACKGROUND ===== */
        .cyber-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 212, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(244, 114, 182, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            z-index: -2;
            animation: float 12s ease-in-out infinite;
        }

        /* ===== GLASS MORPHISM SYSTEM ===== */
        .glass {
            background: var(--glass-light);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-glass);
            border-radius: var(--border-radius);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: var(--shadow-glass);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .glass-card:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(0, 212, 255, 0.5);
            box-shadow: var(--shadow-neon);
            transform: translateY(-5px);
        }

        /* ===== MODERN BUTTONS ===== */
        .cyber-btn {
            background: var(--ai-gradient);
            border: none;
            color: white;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
        }

        .cyber-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-purple);
        }

        .cyber-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .cyber-btn:hover::before {
            left: 100%;
        }

        /* ===== HEADER STYLES ===== */
        .header-glass {
            background: rgba(15, 15, 35, 0.9);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid rgba(0, 212, 255, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .logo-glow {
            text-shadow: 0 0 20px #00D4FF, 0 0 40px #00D4FF;
            animation: neon-glow 3s ease-in-out infinite alternate;
        }

        /* ===== VIDEO CONTAINER ===== */
        .video-cyber {
            background: var(--glass-light);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 24px;
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow-neon);
            transition: var(--transition);
        }

        .video-cyber:hover {
            border-color: rgba(0, 212, 255, 0.8);
            box-shadow: 0 0 50px rgba(0, 212, 255, 0.6);
        }

        /* ===== COUNTER CARDS ===== */
        .counter-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .counter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--neon-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .counter-card:hover::before {
            opacity: 1;
        }

        .counter-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(0, 212, 255, 0.5);
        }

        /* ===== CHART CONTAINERS ===== */
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 24px;
            transition: var(--transition);
        }

        .chart-container:hover {
            border-color: rgba(139, 92, 246, 0.5);
            box-shadow: var(--shadow-purple);
        }

        /* ===== STATUS INDICATORS ===== */
        .status-online {
            width: 12px;
            height: 12px;
            background: #10B981;
            border-radius: 50%;
            animation: scale-pulse 2s infinite;
            box-shadow: 0 0 15px #10B981;
        }

        .status-offline {
            width: 12px;
            height: 12px;
            background: #EF4444;
            border-radius: 50%;
            box-shadow: 0 0 15px #EF4444;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .counter-card {
                padding: 16px;
            }
            
            .chart-container {
                padding: 20px;
            }
        }

        @media (max-width: 640px) {
            .video-cyber {
                border-radius: 16px;
            }
            
            .glass-card {
                border-radius: 12px;
            }
            
            .cyber-btn {
                padding: 12px 24px;
                font-size: 14px;
            }
        }

        /* ===== ANIMATION KEYFRAMES ===== */
        @keyframes neonGlow {
            0% {
                text-shadow: 0 0 10px #00D4FF, 0 0 20px #00D4FF, 0 0 30px #00D4FF;
            }
            100% {
                text-shadow: 0 0 20px #00D4FF, 0 0 30px #00D4FF, 0 0 40px #00D4FF, 0 0 50px #00D4FF;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            33% {
                transform: translateY(-20px) rotate(1deg);
            }
            66% {
                transform: translateY(-10px) rotate(-1deg);
            }
        }

        @keyframes bounceSoft {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes scalePulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        /* ===== SCROLLBAR STYLING ===== */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(15, 15, 35, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--neon-gradient);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #00D4FF 0%, #8B5CF6 100%);
        }

        /* ===== LOADING ANIMATIONS ===== */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 212, 255, 0.3);
            border-top: 4px solid #00D4FF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body class="min-h-screen relative font-inter">
    <!-- Animated Background Effects -->
    <div class="cyber-bg"></div>
    
    <!-- ===== MODERN HEADER ===== -->
    <header class="header-glass fixed top-0 left-0 right-0 z-50">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <!-- Enhanced Logo & Title -->
                <div class="flex items-center space-x-4 animate-slide-up">
                    <div class="w-14 h-14 rounded-2xl bg-gradient-to-r from-neon-blue via-neon-purple to-neon-pink flex items-center justify-center shadow-neon">
                        🦅
                    </div>
                    <div>
                        <div class="text-xl font-bold font-orbitron logo-glow">Swallow AI</div>
                        <div class="text-sm text-gray-300">Ultimate Bird Intelligence V2.0</div>
                    </div>
                </div>
                
                <!-- Enhanced Status & Controls -->
                <div class="flex items-center space-x-6 animate-slide-up">
                    <!-- AI System Status -->
                    <div class="hidden lg:flex items-center space-x-4 glass-card px-4 py-2 rounded-full">
                        <div class="status-online"></div>
                        <span class="text-sm font-medium">AI ACTIVE</span>
                        <span class="text-xs text-gray-300" id="current-time">--:--:--</span>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="flex items-center space-x-2">
                        <button id="search-toggle" title="Search" class="p-3 rounded-lg hover:bg-white/10 transition-all">
                            <i class="fas fa-search text-lg"></i>
                        </button>
                        <button id="fullscreen-toggle" title="Fullscreen" class="p-3 rounded-lg hover:bg-white/10 transition-all">
                            <i class="fas fa-expand text-lg"></i>
                        </button>
                        <button id="lang-toggle" class="px-4 py-2 rounded-lg bg-gradient-to-r from-neon-blue to-neon-purple text-black font-semibold hover:shadow-neon transition-all">
                            <span>ไทย</span>
                        </button>
                        <button id="theme-toggle" class="p-3 rounded-lg hover:bg-white/10 transition-all">
                            <i class="fas fa-moon text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- ===== SEARCH OVERLAY ===== -->
    <div id="search-overlay" class="fixed inset-0 bg-black/80 backdrop-blur-lg z-[60] hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="glass-card max-w-2xl w-full p-8 rounded-3xl animate-scale-pulse">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold font-orbitron">🔍 Smart Search</h3>
                    <button id="close-search" class="p-2 rounded-lg hover:bg-white/10 transition-all">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <input id="search-input" 
                           class="w-full p-4 rounded-xl bg-white/10 border border-white/20 focus:border-neon-blue focus:outline-none transition-all" 
                           placeholder="ค้นหาข้อมูล, การตรวจจับ, สถิติ... / Search data, detections, statistics..."
                           data-th-placeholder="ค้นหาข้อมูล, การตรวจจับ, สถิติ..."
                           data-en-placeholder="Search data, detections, statistics...">
                    
                    <div id="search-results" class="space-y-3 max-h-64 overflow-y-auto">
                        <div class="text-center text-gray-400 py-8">
                            <i class="fas fa-search text-4xl mb-4"></i>
                            <p data-th="เริ่มพิมพ์เพื่อค้นหา..." data-en="Start typing to search...">เริ่มพิมพ์เพื่อค้นหา...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="pt-24 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">
            
            <!-- ===== HERO SECTION - VIDEO STREAM ===== -->
            <section class="animate-fade-in">
                <div class="video-cyber relative">
                    <img id="video-stream" 
                         src="/video_feed" 
                         alt="Live Camera Feed" 
                         class="w-full h-[500px] object-cover">
                    
                    <!-- Video Overlay -->
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent">
                        <!-- Top Status Bar -->
                        <div class="absolute top-6 left-6 right-6 flex justify-between items-center">
                            <div class="glass rounded-full px-4 py-2 flex items-center space-x-3">
                                <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="text-sm font-medium">LIVE</span>
                                <span class="text-xs text-gray-300" id="stream-time">--:--:--</span>
                            </div>
                            
                            <div class="glass rounded-full px-4 py-2">
                                <span class="text-sm" data-th="ความแม่นยำ: " data-en="Accuracy: ">ความแม่นยำ: </span>
                                <span class="font-bold text-neon-green" id="detection-accuracy">98.5%</span>
                            </div>
                        </div>
                        
                        <!-- Bottom Info Panel -->
                        <div class="absolute bottom-6 left-6 right-6">
                            <div class="glass rounded-xl p-6">
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                                    <!-- Birds Detected Today -->
                                    <div class="counter-card bg-gradient-to-br from-neon-blue/30 via-neon-blue/20 to-transparent border-l-4 border-neon-blue">
                                        <div class="flex items-center justify-center mb-2">
                                            <i class="fas fa-dove text-2xl text-neon-blue"></i>
                                        </div>
                                        <div class="text-3xl lg:text-4xl font-bold font-orbitron text-neon-blue mb-1" id="birds-detected">0</div>
                                        <div class="text-sm font-kanit text-gray-300" data-th="นกที่ตรวจพบ" data-en="Birds Detected">นกที่ตรวจพบ</div>
                                        <div class="text-xs text-neon-blue/70 mt-1" data-th="📊 วันนี้" data-en="📊 Today">📊 วันนี้</div>
                                    </div>
                                    
                                    <!-- Birds In Nest -->
                                    <div class="counter-card bg-gradient-to-br from-neon-green/30 via-neon-green/20 to-transparent border-l-4 border-neon-green">
                                        <div class="flex items-center justify-center mb-2">
                                            <i class="fas fa-home text-2xl text-neon-green"></i>
                                        </div>
                                        <div class="text-3xl lg:text-4xl font-bold font-orbitron text-neon-green mb-1" id="birds-in-nest">0</div>
                                        <div class="text-sm font-kanit text-gray-300" data-th="ในรัง" data-en="In Nest">ในรัง</div>
                                        <div class="text-xs text-neon-green/70 mt-1" data-th="🏠 ปัจจุบัน" data-en="🏠 Current">🏠 ปัจจุบัน</div>
                                    </div>
                                    
                                    <!-- Birds Out -->
                                    <div class="counter-card bg-gradient-to-br from-neon-orange/30 via-neon-orange/20 to-transparent border-l-4 border-neon-orange">
                                        <div class="flex items-center justify-center mb-2">
                                            <i class="fas fa-plane-departure text-2xl text-neon-orange"></i>
                                        </div>
                                        <div class="text-3xl lg:text-4xl font-bold font-orbitron text-neon-orange mb-1" id="birds-out">0</div>
                                        <div class="text-sm font-kanit text-gray-300" data-th="นอกรัง" data-en="Outside">นอกรัง</div>
                                        <div class="text-xs text-neon-orange/70 mt-1" data-th="✈️ กำลังบิน" data-en="✈️ Flying">✈️ กำลังบิน</div>
                                    </div>
                                    
                                    <!-- Intruder Detection -->
                                    <div class="counter-card bg-gradient-to-br from-neon-red/30 via-neon-red/20 to-transparent border-l-4 border-neon-red">
                                        <div class="flex items-center justify-center mb-2">
                                            <i class="fas fa-exclamation-triangle text-2xl text-neon-red"></i>
                                        </div>
                                        <div class="text-3xl lg:text-4xl font-bold font-orbitron text-neon-red mb-1" id="intruders-detected">0</div>
                                        <div class="text-sm font-kanit text-gray-300" data-th="ผู้บุกรุก" data-en="Intruders">ผู้บุกรุก</div>
                                        <div class="text-xs text-neon-red/70 mt-1" data-th="⚠️ แจ้งเตือน" data-en="⚠️ Alerts">⚠️ แจ้งเตือน</div>
                                    </div>
                                </div>
                                
                                <!-- Bottom Control Bar -->
                                <div class="flex items-center justify-between mt-6 pt-4 border-t border-white/10">
                                    <div class="flex items-center space-x-4">
                                        <button onclick="toggleRecording()" class="cyber-btn">
                                            <i class="fas fa-video mr-2"></i>
                                            <span data-th="บันทึก" data-en="Record">บันทึก</span>
                                        </button>
                                        <button onclick="takeSnapshot()" class="cyber-btn bg-gradient-to-r from-neon-green to-neon-blue">
                                            <i class="fas fa-camera mr-2"></i>
                                            <span data-th="ถ่ายภาพ" data-en="Snapshot">ถ่ายภาพ</span>
                                        </button>
                                    </div>
                                    
                                    <div class="flex items-center space-x-4 text-sm text-gray-300">
                                        <div class="flex items-center space-x-2">
                                            <i class="fas fa-wifi text-neon-green"></i>
                                            <span data-th="เชื่อมต่อแล้ว" data-en="Connected">เชื่อมต่อแล้ว</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <i class="fas fa-microchip text-neon-blue"></i>
                                            <span data-th="AI เปิดใช้งาน" data-en="AI Active">AI เปิดใช้งาน</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <!-- ===== ENHANCED DASHBOARD SECTION ===== -->
            <section class="animate-slide-up">
                <div class="glass-card rounded-3xl p-8 mb-8">
                    <h2 class="text-3xl font-bold font-orbitron mb-6 flex items-center">
                        <i class="fas fa-chart-line text-neon-blue mr-4"></i>
                        <span data-th="แดชบอร์ดวิเคราะห์ AI" data-en="AI Analytics Dashboard">แดชบอร์ดวิเคราะห์ AI</span>
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">
                        <!-- Today Activity -->
                        <div class="glass rounded-xl p-6 text-center">
                            <div class="flex items-center justify-center mb-4">
                                <div class="w-16 h-16 rounded-full bg-gradient-to-r from-neon-blue to-neon-purple flex items-center justify-center">
                                    <i class="fas fa-calendar-day text-2xl text-white"></i>
                                </div>
                            </div>
                            <h3 class="text-2xl font-bold text-neon-blue mb-2" id="today-activity">0</h3>
                            <p class="text-gray-300" data-th="กิจกรรมวันนี้" data-en="Today's Activity">กิจกรรมวันนี้</p>
                            <div class="mt-2 text-sm">
                                <span class="text-neon-green">+15%</span>
                                <span class="text-gray-400" data-th="จากเมื่อวาน" data-en="vs yesterday">จากเมื่อวาน</span>
                            </div>
                        </div>
                        
                        <!-- Weekly Average -->
                        <div class="glass rounded-xl p-6 text-center">
                            <div class="flex items-center justify-center mb-4">
                                <div class="w-16 h-16 rounded-full bg-gradient-to-r from-neon-green to-neon-blue flex items-center justify-center">
                                    <i class="fas fa-chart-bar text-2xl text-white"></i>
                                </div>
                            </div>
                            <h3 class="text-2xl font-bold text-neon-green mb-2" id="weekly-average">0</h3>
                            <p class="text-gray-300" data-th="เฉลี่ยสัปดาห์" data-en="Weekly Average">เฉลี่ยสัปดาห์</p>
                            <div class="mt-2 text-sm">
                                <span class="text-neon-blue">Stable</span>
                                <span class="text-gray-400" data-th="แนวโน้ม" data-en="trend">แนวโน้ม</span>
                            </div>
                        </div>
                        
                        <!-- Detection Rate -->
                        <div class="glass rounded-xl p-6 text-center">
                            <div class="flex items-center justify-center mb-4">
                                <div class="w-16 h-16 rounded-full bg-gradient-to-r from-neon-purple to-neon-pink flex items-center justify-center">
                                    <i class="fas fa-bullseye text-2xl text-white"></i>
                                </div>
                            </div>
                            <h3 class="text-2xl font-bold text-neon-purple mb-2" id="detection-rate">98.5%</h3>
                            <p class="text-gray-300" data-th="อัตราตรวจจับ" data-en="Detection Rate">อัตราตรวจจับ</p>
                            <div class="mt-2 text-sm">
                                <span class="text-neon-green">Excellent</span>
                                <span class="text-gray-400" data-th="สถานะ" data-en="status">สถานะ</span>
                            </div>
                        </div>
                        
                        <!-- System Uptime -->
                        <div class="glass rounded-xl p-6 text-center">
                            <div class="flex items-center justify-center mb-4">
                                <div class="w-16 h-16 rounded-full bg-gradient-to-r from-neon-orange to-neon-red flex items-center justify-center">
                                    <i class="fas fa-clock text-2xl text-white"></i>
                                </div>
                            </div>
                            <h3 class="text-2xl font-bold text-neon-orange mb-2" id="system-uptime">99.9%</h3>
                            <p class="text-gray-300" data-th="เวลาทำงาน" data-en="System Uptime">เวลาทำงาน</p>
                            <div class="mt-2 text-sm">
                                <span class="text-neon-green">5d 12h</span>
                                <span class="text-gray-400" data-th="ต่อเนื่อง" data-en="continuous">ต่อเนื่อง</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===== REAL-TIME CHARTS SECTION ===== -->
            <section class="animate-fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Real-time Detection Chart -->
                    <div class="chart-container">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-chart-line text-neon-blue mr-3"></i>
                            <span data-th="การตรวจจับแบบเรียลไทม์" data-en="Real-time Detections">การตรวจจับแบบเรียลไทม์</span>
                        </h2>
                        <canvas id="realtime-chart" class="w-full h-64"></canvas>
                    </div>
                    
                    <!-- Hourly Distribution Chart -->
                    <div class="chart-container">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-chart-bar text-neon-purple mr-3"></i>
                            <span data-th="การกระจายตัวรายชั่วโมง" data-en="Hourly Distribution">การกระจายตัวรายชั่วโมง</span>
                        </h2>
                        <canvas id="hourly-chart" class="w-full h-64"></canvas>
                    </div>
                </div>
            </section>

            <!-- ===== ADVANCED ANALYTICS GRID ===== -->
            <section class="animate-slide-left">
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
                    <!-- Species Detection -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <i class="fas fa-dove text-neon-blue mr-3"></i>
                            <span data-th="ชนิดนกที่ตรวจพบ" data-en="Species Detected">ชนิดนกที่ตรวจพบ</span>
                        </h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-gray-300">นกแอ่น / Swallow</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-16 h-2 bg-gray-700 rounded-full overflow-hidden">
                                        <div class="w-4/5 h-full bg-gradient-to-r from-neon-blue to-neon-purple"></div>
                                    </div>
                                    <span class="text-sm text-neon-blue font-medium">80%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-300">นกกระจอก / Sparrow</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-16 h-2 bg-gray-700 rounded-full overflow-hidden">
                                        <div class="w-1/5 h-full bg-gradient-to-r from-neon-green to-neon-blue"></div>
                                    </div>
                                    <span class="text-sm text-neon-green font-medium">15%</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-300">อื่นๆ / Others</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-16 h-2 bg-gray-700 rounded-full overflow-hidden">
                                        <div class="w-1/10 h-full bg-gradient-to-r from-neon-orange to-neon-red"></div>
                                    </div>
                                    <span class="text-sm text-neon-orange font-medium">5%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Activity Patterns -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <i class="fas fa-clock text-neon-green mr-3"></i>
                            <span data-th="รูปแบบกิจกรรม" data-en="Activity Patterns">รูปแบบกิจกรรม</span>
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-sun text-neon-orange"></i>
                                    <span class="text-gray-300" data-th="เช้า (06:00-12:00)" data-en="Morning (06:00-12:00)">เช้า (06:00-12:00)</span>
                                </div>
                                <span class="text-neon-orange font-bold">45%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-sun text-neon-blue"></i>
                                    <span class="text-gray-300" data-th="บ่าย (12:00-18:00)" data-en="Afternoon (12:00-18:00)">บ่าย (12:00-18:00)</span>
                                </div>
                                <span class="text-neon-blue font-bold">35%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-moon text-neon-purple"></i>
                                    <span class="text-gray-300" data-th="เย็น (18:00-00:00)" data-en="Evening (18:00-00:00)">เย็น (18:00-00:00)</span>
                                </div>
                                <span class="text-neon-purple font-bold">20%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Weather Impact -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <i class="fas fa-cloud-sun text-neon-pink mr-3"></i>
                            <span data-th="ผลกระทบสภาพอากาศ" data-en="Weather Impact">ผลกระทบสภาพอากาศ</span>
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-sun text-yellow-400"></i>
                                    <span class="text-gray-300" data-th="แจ่มใส" data-en="Sunny">แจ่มใส</span>
                                </div>
                                <span class="text-neon-green font-bold">High</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-cloud text-gray-400"></i>
                                    <span class="text-gray-300" data-th="มีเม็ด" data-en="Cloudy">มีเมฆ</span>
                                </div>
                                <span class="text-neon-blue font-bold">Medium</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-cloud-rain text-blue-400"></i>
                                    <span class="text-gray-300" data-th="ฝนตก" data-en="Rainy">ฝนตก</span>
                                </div>
                                <span class="text-neon-red font-bold">Low</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">
      <!-- Video Stream -->
      <section>
        <div class="video-cyber relative">
          <img id="video-stream" src="/video_feed" alt="Video Stream" class="w-full aspect-video object-cover" />
          <div class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/70 to-transparent flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <span class="text-red-500 font-bold">● LIVE</span>
              <span id="stream-time" class="text-sm text-gray-300">--:--:--</span>
            </div>
            <div class="text-xs text-gray-300">FPS: <span id="processing-speed">-</span> | Acc: <span id="accuracy-rate">-</span> | Mem: <span id="memory-usage">-</span></div>
          </div>
        </div>
      </section>

      <!-- Counters -->
      <section>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="glass-card p-4 text-center">
            <div class="text-xs text-gray-300">Birds In</div>
            <div id="birds-in" class="text-3xl font-bold">0</div>
          </div>
          <div class="glass-card p-4 text-center">
            <div class="text-xs text-gray-300">Birds Out</div>
            <div id="birds-out" class="text-3xl font-bold">0</div>
          </div>
          <div class="glass-card p-4 text-center">
            <div class="text-xs text-gray-300">In Nest</div>
            <div id="birds-remaining" class="text-3xl font-bold">0</div>
          </div>
          <div class="glass-card p-4 text-center">
            <div class="text-xs text-gray-300">Intruders</div>
            <div id="intruders-detected" class="text-3xl font-bold text-neon-red">0</div>
          </div>
        </div>
      </section>

      <!-- Charts -->
      <section>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glass-card p-4">
            <div class="flex items-center justify-between mb-2">
              <h3 class="font-orbitron">Real-time Detections</h3>
              <span id="current-time" class="text-xs text-gray-300">--:--:--</span>
            </div>
            <canvas id="realtime-chart" class="w-full h-64"></canvas>
          </div>
          <div class="glass-card p-4">
            <h3 class="font-orbitron mb-2">Hourly Activity</h3>
            <canvas id="hourly-chart" class="w-full h-64"></canvas>
          </div>
        </div>
      </section>

      <!-- Notifications & Anomaly Gallery -->
      <section>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glass-card p-4">
            <h3 class="font-orbitron mb-3">Notifications</h3>
            <div id="notifications" class="space-y-2 max-h-80 overflow-auto"></div>
          </div>
          <div class="glass-card p-4">
            <h3 class="font-orbitron mb-3">Anomaly Images</h3>
            <div id="anomaly-gallery" class="grid grid-cols-2 md:grid-cols-3 gap-3 max-h-80 overflow-auto"></div>
          </div>
        </div>
      </section>

      <!-- Data Management -->
      <section>
        <div class="glass-card p-4">
          <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4">
            <div>
              <h3 class="font-orbitron">Data Management</h3>
              <div class="text-xs text-gray-300">Oldest record: <span id="oldest-data">-</span></div>
            </div>
            <div class="flex items-center gap-2">
              <label class="text-sm">Keep last (days)</label>
              <input id="retention-period" type="number" min="1" value="7" class="w-20 p-2 rounded bg-white/10 border border-white/20" />
              <button id="btn-delete-old" class="px-3 py-2 rounded bg-neon-red/80 hover:bg-neon-red">Delete Old</button>
              <button id="btn-export" class="px-3 py-2 rounded bg-neon-blue/80 hover:bg-neon-blue text-black">Export</button>
            </div>
          </div>
        </div>
            <!-- ===== NOTIFICATIONS & ALERTS SECTION ===== -->
            <section class="animate-slide-right">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Real-time Notifications -->
                    <div class="glass-card rounded-xl p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-bell text-neon-blue mr-3"></i>
                                <span data-th="การแจ้งเตือนแบบเรียลไทม์" data-en="Real-time Notifications">การแจ้งเตือนแบบเรียลไทม์</span>
                            </div>
                            <span class="text-xs bg-neon-blue/20 text-neon-blue px-2 py-1 rounded-full" id="notification-count">0</span>
                        </h2>
                        
                        <div id="notifications-container" class="space-y-3 max-h-80 overflow-y-auto">
                            <!-- Notifications will be populated here -->
                            <div class="flex items-center space-x-3 p-3 rounded-lg bg-white/5 border-l-4 border-neon-green">
                                <i class="fas fa-check-circle text-neon-green"></i>
                                <div>
                                    <div class="text-sm font-medium" data-th="ระบบเริ่มต้นสำเร็จ" data-en="System initialized successfully">ระบบเริ่มต้นสำเร็จ</div>
                                    <div class="text-xs text-gray-400" data-th="เมื่อกี้นี้" data-en="Just now">เมื่อกี้นี้</div>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-3 p-3 rounded-lg bg-white/5 border-l-4 border-neon-blue">
                                <i class="fas fa-dove text-neon-blue"></i>
                                <div>
                                    <div class="text-sm font-medium" data-th="ตรวจพบนกแอ่น 3 ตัว" data-en="3 swallows detected">ตรวจพบนกแอ่น 3 ตัว</div>
                                    <div class="text-xs text-gray-400" data-th="2 นาทีที่แล้ว" data-en="2 minutes ago">2 นาทีที่แล้ว</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 pt-4 border-t border-white/10">
                            <button onclick="clearNotifications()" class="w-full py-2 text-sm text-gray-400 hover:text-white transition-colors">
                                <i class="fas fa-trash mr-2"></i>
                                <span data-th="ลบการแจ้งเตือนทั้งหมด" data-en="Clear All Notifications">ลบการแจ้งเตือนทั้งหมด</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Alert Log -->
                    <div class="glass-card rounded-xl p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-exclamation-triangle text-neon-red mr-3"></i>
                                <span data-th="บันทึกการแจ้งเตือน" data-en="Alert Log">บันทึกการแจ้งเตือน</span>
                            </div>
                            <button onclick="exportAlerts()" class="text-xs bg-neon-red/20 text-neon-red px-2 py-1 rounded-full hover:bg-neon-red/30 transition-colors">
                                <i class="fas fa-download mr-1"></i>
                                <span data-th="ส่งออก" data-en="Export">ส่งออก</span>
                            </button>
                        </h2>
                        
                        <div id="alerts-container" class="space-y-3 max-h-80 overflow-y-auto">
                            <!-- Alerts will be populated here -->
                            <div class="flex items-center space-x-3 p-3 rounded-lg bg-red-500/10 border border-red-500/20">
                                <i class="fas fa-exclamation-triangle text-red-400"></i>
                                <div class="flex-1">
                                    <div class="text-sm font-medium text-red-300" data-th="ตรวจพบผู้บุกรุก" data-en="Intruder detected">ตรวจพบผู้บุกรุก</div>
                                    <div class="text-xs text-gray-400" data-th="มุม A - ความเชื่อมั่น 95%" data-en="Zone A - Confidence 95%">มุม A - ความเชื่อมั่น 95%</div>
                                    <div class="text-xs text-gray-500" data-th="5 นาทีที่แล้ว" data-en="5 minutes ago">5 นาทีที่แล้ว</div>
                                </div>
                                <button class="text-red-400 hover:text-red-300 transition-colors">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            
                            <div class="flex items-center space-x-3 p-3 rounded-lg bg-orange-500/10 border border-orange-500/20">
                                <i class="fas fa-exclamation-circle text-orange-400"></i>
                                <div class="flex-1">
                                    <div class="text-sm font-medium text-orange-300" data-th="การเคลื่อนไหวผิดปกติ" data-en="Unusual movement detected">การเคลื่อนไหวผิดปกติ</div>
                                    <div class="text-xs text-gray-400" data-th="มุม B - กิจกรรมสูงผิดปกติ" data-en="Zone B - Unusual high activity">มุม B - กิจกรรมสูงผิดปกติ</div>
                                    <div class="text-xs text-gray-500" data-th="15 นาทีที่แล้ว" data-en="15 minutes ago">15 นาทีที่แล้ว</div>
                                </div>
                                <button class="text-orange-400 hover:text-orange-300 transition-colors">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===== DATABASE & SYSTEM MANAGEMENT ===== -->
            <section class="animate-fade-in">
                <div class="glass-card rounded-xl p-8 mb-8">
                    <h2 class="text-2xl font-bold mb-6 flex items-center">
                        <i class="fas fa-database text-neon-purple mr-4"></i>
                        <span data-th="การจัดการฐานข้อมูลและระบบ" data-en="Database & System Management">การจัดการฐานข้อมูลและระบบ</span>
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Database Statistics -->
                        <div class="glass rounded-xl p-6">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <i class="fas fa-chart-pie text-neon-blue mr-3"></i>
                                <span data-th="สถิติฐานข้อมูล" data-en="Database Statistics">สถิติฐานข้อมูล</span>
                            </h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-300" data-th="รวมบันทึก" data-en="Total Records">รวมบันทึก:</span>
                                    <span class="font-bold text-neon-blue" id="total-records">0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300" data-th="ข้อมูลเก่าสุด" data-en="Oldest Data">ข้อมูลเก่าสุด:</span>
                                    <span class="font-bold text-neon-green" id="oldest-data">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300" data-th="ขนาดฐานข้อมูล" data-en="Database Size">ขนาดฐานข้อมูล:</span>
                                    <span class="font-bold text-neon-purple" id="database-size">0 MB</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Data Management Actions -->
                        <div class="glass rounded-xl p-6">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <i class="fas fa-tools text-neon-green mr-3"></i>
                                <span data-th="การจัดการข้อมูล" data-en="Data Management">การจัดการข้อมูล</span>
                            </h3>
                            <div class="space-y-3">
                                <div class="flex items-center space-x-2">
                                    <select id="retention-period" class="flex-1 p-2 rounded bg-white/10 border border-white/20 text-white">
                                        <option value="7" data-th="7 วัน" data-en="7 days">7 วัน</option>
                                        <option value="30" data-th="30 วัน" data-en="30 days">30 วัน</option>
                                        <option value="90" data-th="90 วัน" data-en="90 days">90 วัน</option>
                                    </select>
                                    <button onclick="deleteOldData()" class="px-4 py-2 bg-neon-red rounded hover:bg-neon-red/80 transition-colors">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <button onclick="exportData()" class="w-full py-2 bg-neon-blue rounded hover:bg-neon-blue/80 transition-colors">
                                    <i class="fas fa-download mr-2"></i>
                                    <span data-th="ส่งออกข้อมูล" data-en="Export Data">ส่งออกข้อมูล</span>
                                </button>
                                <button onclick="backupDatabase()" class="w-full py-2 bg-neon-green rounded hover:bg-neon-green/80 transition-colors">
                                    <i class="fas fa-save mr-2"></i>
                                    <span data-th="สำรองข้อมูล" data-en="Backup Database">สำรองข้อมูล</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- System Performance -->
                        <div class="glass rounded-xl p-6">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <i class="fas fa-tachometer-alt text-neon-orange mr-3"></i>
                                <span data-th="ประสิทธิภาพระบบ" data-en="System Performance">ประสิทธิภาพระบบ</span>
                            </h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-300" data-th="CPU" data-en="CPU">CPU:</span>
                                    <span class="font-bold text-neon-orange" id="cpu-usage">0%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300" data-th="หน่วยความจำ" data-en="Memory">หน่วยความจำ:</span>
                                    <span class="font-bold text-neon-pink" id="memory-usage">0%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300" data-th="FPS" data-en="FPS">FPS:</span>
                                    <span class="font-bold text-neon-blue" id="fps-rate">0</span>
                                </div>
                                <button onclick="optimizeSystem()" class="w-full py-2 bg-neon-purple rounded hover:bg-neon-purple/80 transition-colors mt-3">
                                    <i class="fas fa-magic mr-2"></i>
                                    <span data-th="เพิ่มประสิทธิภาพ" data-en="Optimize System">เพิ่มประสิทธิภาพ</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===== ANOMALY DETECTION GALLERY ===== -->
            <section class="animate-slide-up">
                <div class="glass-card rounded-xl p-8 mb-8">
                    <h2 class="text-2xl font-bold mb-6 flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-images text-neon-pink mr-4"></i>
                            <span data-th="แกลเลอรีภาพผิดปกติ" data-en="Anomaly Detection Gallery">แกลเลอรีภาพผิดปกติ</span>
                        </div>
                        <button onclick="refreshAnomalyGallery()" class="px-4 py-2 bg-neon-pink rounded hover:bg-neon-pink/80 transition-colors">
                            <i class="fas fa-sync-alt mr-2"></i>
                            <span data-th="รีเฟรช" data-en="Refresh">รีเฟรช</span>
                        </button>
                    </h2>
                    
                    <div id="anomaly-gallery" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <!-- Anomaly images will be populated here -->
                        <div class="aspect-square bg-white/5 rounded-lg border-2 border-dashed border-white/20 flex items-center justify-center">
                            <i class="fas fa-image text-gray-400 text-2xl"></i>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    <!-- ===== ULTRA MODERN FOOTER ===== -->
    <footer class="glass-card mt-16 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <!-- Company Info -->
                <div class="space-y-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-neon-blue via-neon-purple to-neon-pink flex items-center justify-center">
                            🦅
                        </div>
                        <div>
                            <div class="font-bold font-orbitron">Swallow AI</div>
                            <div class="text-xs text-gray-400">V2.0</div>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm" data-th="ระบบตรวจจับนกอัจฉริยะที่ทันสมัยที่สุด" data-en="The most advanced AI bird detection system">ระบบตรวจจับนกอัจฉริยะที่ทันสมัยที่สุด</p>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h4 class="font-bold text-white mb-4 font-orbitron" data-th="ลิงก์ด่วน" data-en="Quick Links">ลิงก์ด่วน</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-300 hover:text-neon-blue transition-colors" data-th="แดชบอร์ด" data-en="Dashboard">แดชบอร์ด</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-neon-blue transition-colors" data-th="การตั้งค่า" data-en="Settings">การตั้งค่า</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-neon-blue transition-colors" data-th="รายงาน" data-en="Reports">รายงาน</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-neon-blue transition-colors" data-th="ช่วยเหลือ" data-en="Help">ช่วยเหลือ</a></li>
                    </ul>
                </div>
                
                <!-- System Status -->
                <div>
                    <h4 class="font-bold text-white mb-4 font-orbitron" data-th="สถานะระบบ" data-en="System Status">สถานะระบบ</h4>
                    <div class="space-y-3 text-sm">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-300" data-th="AI Engine" data-en="AI Engine">AI Engine</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-neon-green rounded-full animate-pulse"></div>
                                <span class="text-xs text-neon-green" data-th="ออนไลน์" data-en="Online">ออนไลน์</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-300" data-th="กล้อง" data-en="Camera">กล้อง</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-neon-green rounded-full animate-pulse"></div>
                                <span class="text-xs text-neon-green" data-th="เชื่อมต่อแล้ว" data-en="Connected">เชื่อมต่อแล้ว</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-300" data-th="ฐานข้อมูล" data-en="Database">ฐานข้อมูล</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-neon-green rounded-full animate-pulse"></div>
                                <span class="text-xs text-neon-green" data-th="เชื่อมต่อแล้ว" data-en="Connected">เชื่อมต่อแล้ว</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Metrics -->
                <div>
                    <h4 class="font-bold text-white mb-4 font-orbitron" data-th="ประสิทธิภาพ" data-en="Performance">ประสิทธิภาพ</h4>
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-300" data-th="ความแม่นยำ" data-en="Accuracy">ความแม่นยำ:</span>
                            <span class="font-bold text-neon-green">98.5%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-300" data-th="เวลาตอบสนอง" data-en="Response Time">เวลาตอบสนอง:</span>
                            <span class="font-bold text-neon-blue">15ms</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-300" data-th="เวลาทำงาน" data-en="Uptime">เวลาทำงาน:</span>
                            <span class="font-bold text-neon-purple">99.9%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 pt-8">
                <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0">
                    <div class="text-gray-400 text-sm text-center md:text-left">
                        <span data-th="© 2025 Swallow AI. สงวนลิขสิทธิ์" data-en="© 2025 Swallow AI. All rights reserved.">© 2025 Swallow AI. สงวนลิขสิทธิ์</span>
                    </div>
                    <div class="flex items-center space-x-6 text-sm">
                        <span class="text-gray-400" data-th="ขับเคลื่อนโดย AI" data-en="Powered by AI">ขับเคลื่อนโดย AI</span>
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-heart text-red-500 animate-pulse"></i>
                            <span class="text-gray-400" data-th="ด้วยความรัก" data-en="Made with love">ด้วยความรัก</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- ===== AI CHATBOT (FIXED POSITION) ===== -->
    <div id="ai-chatbot" class="fixed bottom-6 right-6 z-50">
        <!-- Chat Toggle Button -->
        <button id="chat-toggle" onclick="toggleChat()" class="w-16 h-16 rounded-full bg-gradient-to-r from-neon-blue to-neon-purple flex items-center justify-center shadow-neon hover:shadow-lg transition-all duration-300 transform hover:scale-110">
            <i class="fas fa-robot text-white text-xl"></i>
        </button>
        
        <!-- Chat Window -->
        <div id="chat-window" class="hidden absolute bottom-20 right-0 w-96 h-[500px] glass-card rounded-2xl overflow-hidden animate-slide-up">
            <!-- Chat Header -->
            <div class="bg-gradient-to-r from-neon-blue to-neon-purple p-4 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center">
                        <i class="fas fa-robot text-white"></i>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-th="Swallow AI Assistant" data-en="Swallow AI Assistant">Swallow AI Assistant</div>
                        <div class="text-xs text-white/80" data-th="ออนไลน์" data-en="Online">ออนไลน์</div>
                    </div>
                </div>
                <button onclick="toggleChat()" class="text-white/80 hover:text-white transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Chat Messages -->
            <div id="chat-messages" class="h-80 overflow-y-auto p-4 space-y-3 bg-black/20">
                <div class="flex space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-r from-neon-blue to-neon-purple rounded-full flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-robot text-white text-sm"></i>
                    </div>
                    <div class="glass rounded-xl p-3 max-w-xs">
                        <p class="text-sm" data-th="สวัสดีครับ! ผมคือ AI ผู้ช่วยของระบบ Swallow AI พร้อมช่วยเหลือคุณแล้วครับ" data-en="Hello! I'm Swallow AI Assistant, ready to help you with the bird monitoring system.">สวัสดีครับ! ผมคือ AI ผู้ช่วยของระบบ Swallow AI พร้อมช่วยเหลือคุณแล้วครับ</p>
                    </div>
                </div>
            </div>
            
            <!-- Chat Input -->
            <div class="p-4 border-t border-white/10 bg-black/20">
                <div class="flex space-x-2">
                    <input type="text" 
                           id="chat-input"
                           class="flex-1 p-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-gray-400 focus:border-neon-blue focus:outline-none transition-all" 
                           placeholder="พิมพ์ข้อความ..."
                           data-th-placeholder="พิมพ์ข้อความ..."
                           data-en-placeholder="Type your message..."
                           onkeypress="if(event.key === 'Enter') sendMessage()">
                    <button onclick="sendMessage()" class="cyber-btn px-4 py-3">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>  <!-- Footer -->
  <footer class="mt-10 py-6 border-t border-white/10 text-sm text-center text-gray-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">© <span id="year"></span> Swallow AI — Ultimate AI Bird Intelligence System V2.0</div>
  </footer>

  <!-- Floating Chat -->
  <div id="ai-chatbot" class="fixed bottom-4 right-4 w-[360px] max-w-[calc(100vw-2rem)] glass-card overflow-hidden">
    <div class="bg-gradient-to-r from-neon-blue to-neon-purple px-4 py-3 flex items-center justify-between cursor-pointer" onclick="toggleChat()">
      <div class="flex items-center gap-2">
        <div class="w-7 h-7 rounded-lg bg-black/20 flex items-center justify-center">🤖</div>
        <div class="font-orbitron">AI Assistant</div>
      </div>
      <div class="status-dot bg-neon-green"></div>
    </div>
    <div id="chat-body" class="max-h-80 overflow-y-auto p-3 space-y-2 hidden">
      <div class="text-xs text-gray-300">Ask about detections, stats, or commands.</div>
      <div id="chat-messages" class="space-y-2"></div>
      <div class="flex items-center gap-2 pt-2">
        <input id="chat-input" class="flex-1 p-2 rounded bg-white/10 border border-white/20" placeholder="พิมพ์ข้อความ / Type message..." />
        <button id="chat-send" class="px-3 py-2 rounded bg-neon-blue/80 text-black">Send</button>
      </div>
    </div>
  </div>

  <script>
    // Globals
    let currentLang = 'th';
    let isDark = false;
    let realtimeChart, hourlyChart;

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('year').textContent = new Date().getFullYear();
      setupUI();
      initCharts();
      loadInitialData();
      updateTime();
      setInterval(updateTime, 1000);
      window.updateInterval = setInterval(updateRealTimeData, 5000);
    });

    function setupUI() {
      // Theme
      const themeBtn = document.getElementById('theme-toggle');
      themeBtn?.addEventListener('click', () => {
        isDark = !isDark;
        document.documentElement.classList.toggle('dark', isDark);
        themeBtn.innerHTML = `<i class="fa ${isDark ? 'fa-sun' : 'fa-moon'}"></i>`;
      });

      // Lang
      const langBtn = document.getElementById('lang-toggle');
      langBtn?.addEventListener('click', toggleLanguage);

      // Search
      setupSearchFeature();

      // Fullscreen
      const fsBtn = document.getElementById('fullscreen-toggle');
      fsBtn?.addEventListener('click', () => { if (!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen(); });

      // Data actions
      document.getElementById('btn-delete-old')?.addEventListener('click', deleteOldData);
      document.getElementById('btn-export')?.addEventListener('click', exportData);

      // Chat
      document.getElementById('chat-send')?.addEventListener('click', sendMessage);
      document.getElementById('chat-input')?.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });

      // Keyboard shortcut: Ctrl+K for chat
      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'k') {
          e.preventDefault();
          toggleChat(true);
          document.getElementById('chat-input')?.focus();
        }
      });
    }

    function toggleLanguage() {
      currentLang = currentLang === 'th' ? 'en' : 'th';
      const btn = document.querySelector('#lang-toggle span');
      if (btn) btn.textContent = currentLang === 'th' ? 'ไทย' : 'EN';
      document.querySelectorAll('[data-th][data-en]')?.forEach(el => {
        const text = currentLang === 'th' ? el.getAttribute('data-th') : el.getAttribute('data-en');
        if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = text; else el.textContent = text;
      });
    }

    function setupSearchFeature() {
      const toggle = document.getElementById('search-toggle');
      const overlay = document.getElementById('search-overlay');
      const closeBtn = document.getElementById('close-search');
      const input = document.getElementById('search-input');
      const results = document.getElementById('search-results');

      const open = () => { overlay?.classList.remove('hidden'); setTimeout(() => input?.focus(), 100); };
      const close = () => { overlay?.classList.add('hidden'); input.value = ''; results.innerHTML = ''; };

      toggle?.addEventListener('click', open);
      closeBtn?.addEventListener('click', close);
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); });
      input?.addEventListener('input', (e) => performSearch(e.target.value.trim(), results));
    }

    function performSearch(query, resultsEl) {
      if (!resultsEl) return;
      resultsEl.innerHTML = '';
      if (!query) return;

      const items = [];
      const q = query.toLowerCase();
      if (q.includes('นก') || q.includes('bird')) items.push({ label: 'Bird Counters', action: () => scrollToId('birds-in') });
      if (q.includes('security') || q.includes('ผู้บุกรุก') || q.includes('intruder')) items.push({ label: 'Intruders', action: () => scrollToId('intruders-detected') });
      if (q.includes('สถิติ') || q.includes('stats') || q.includes('chart')) items.push({ label: 'Realtime Chart', action: () => scrollToId('realtime-chart') });

      items.forEach(it => {
        const row = document.createElement('div');
        row.className = 'p-2 rounded hover:bg-white/10 cursor-pointer';
        row.textContent = it.label;
        row.onclick = () => { it.action(); document.getElementById('search-overlay')?.classList.add('hidden'); };
        resultsEl.appendChild(row);
      });
    }

    function scrollToId(id) { document.getElementById(id)?.scrollIntoView({ behavior: 'smooth', block: 'center' }); }

    function toggleChat(forceOpen = false) {
      const body = document.getElementById('chat-body');
      if (!body) return;
      if (forceOpen) body.classList.remove('hidden'); else body.classList.toggle('hidden');
    }

    function updateTime() {
      const now = new Date();
      const t = now.toLocaleTimeString('th-TH');
      const el = document.getElementById('current-time'); if (el) el.textContent = t;
      const st = document.getElementById('stream-time'); if (st) st.textContent = t;
    }

    // Charts
    function initCharts() {
      const rtCtx = document.getElementById('realtime-chart')?.getContext('2d');
      const hrCtx = document.getElementById('hourly-chart')?.getContext('2d');
      if (rtCtx) {
        realtimeChart = new Chart(rtCtx, {
          type: 'line',
          data: { datasets: [{ label: 'Detections', data: [], borderColor: '#00D4FF', backgroundColor: 'rgba(0,212,255,.12)', fill: true, tension: .35 }] },
          options: {
            responsive: true, parsing: false,
            scales: {
              x: { type: 'time', time: { unit: 'minute' }, grid: { color: 'rgba(255,255,255,.1)' }, ticks: { color: 'rgba(255,255,255,.8)' } },
              y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,.08)' }, ticks: { color: 'rgba(255,255,255,.8)', precision: 0 } }
            },
            plugins: { legend: { labels: { color: 'rgba(255,255,255,.85)' } } }
          }
        });
      }
      if (hrCtx) {
        hourlyChart = new Chart(hrCtx, {
          type: 'bar',
          data: { labels: Array.from({ length: 24 }, (_, i) => `${i}:00`), datasets: [{ label: 'Per Hour', data: new Array(24).fill(0), backgroundColor: 'rgba(139,92,246,.5)' }] },
          options: {
            responsive: true,
            scales: {
              x: { grid: { color: 'rgba(255,255,255,.06)' }, ticks: { color: 'rgba(255,255,255,.8)' } },
              y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,.08)' }, ticks: { color: 'rgba(255,255,255,.8)', precision: 0 } }
            },
            plugins: { legend: { labels: { color: 'rgba(255,255,255,.85)' } } }
          }
        });
      }
    }

    function updateRealtimeChartPoint(y) {
      if (!realtimeChart) return;
      const ds = realtimeChart.data.datasets[0];
      ds.data.push({ x: new Date(), y });
      const cutoff = Date.now() - 60 * 60 * 1000; // 1h
      ds.data = ds.data.filter(p => new Date(p.x).getTime() >= cutoff);
      realtimeChart.update('none');
    }

    function updateHourlyChartData(arr) { if (!hourlyChart || !Array.isArray(arr)) return; hourlyChart.data.datasets[0].data = arr.slice(0, 24); hourlyChart.update(); }

    // Data loaders
    function loadInitialData() { updateRealTimeData(); loadNotifications(); loadAnomalyData(); loadDatabaseStats(); }

    function updateRealTimeData() {
      fetch('/api/stats').then(r => r.json()).then(data => {
        if (data) {
          setText('birds-in', data.birds_in ?? 0);
          setText('birds-out', data.birds_out ?? 0);
          setText('birds-remaining', data.birds_remaining ?? 0);
          setText('intruders-detected', data.intruders ?? 0);
          setText('processing-speed', data.fps ? `${data.fps} FPS` : '-');
          setText('accuracy-rate', data.accuracy ? `${data.accuracy}%` : '-');
          setText('memory-usage', data.memory ? `${data.memory}%` : '-');
          if (typeof data.current_detection === 'number') updateRealtimeChartPoint(data.current_detection);
        }
      }).catch(console.error);

      fetch('/api/statistics').then(r => r.json()).then(data => { if (data?.hourly) updateHourlyChartData(data.hourly); }).catch(console.error);
    }

    function loadNotifications() {
      fetch('/api/notifications').then(r => r.json()).then(list => {
        const box = document.getElementById('notifications'); if (!box) return; box.innerHTML = '';
        (list || []).slice(0, 20).forEach(n => {
          const row = document.createElement('div');
          row.className = 'p-3 rounded border border-white/10 bg-white/5 flex items-start gap-2';
          row.innerHTML = `<div class=\"w-2 h-2 rounded-full mt-1 ${n.level === 'error' ? 'bg-red-500' : n.level === 'warning' ? 'bg-orange-500' : 'bg-cyan-400'}\"></div>
                           <div><div class=\"text-sm\">${escapeHtml(n.title || 'Notification')}</div>
                           <div class=\"text-xs text-gray-300\">${escapeHtml(n.message || '')}</div></div>`;
          box.appendChild(row);
        });
      }).catch(console.error);
    }

    function loadAnomalyData() {
      fetch('/api/anomaly-images').then(r => r.json()).then(list => {
        const grid = document.getElementById('anomaly-gallery'); if (!grid) return; grid.innerHTML = '';
        (list || []).slice(0, 24).forEach(src => {
          const img = document.createElement('img'); img.src = src; img.alt = 'Anomaly'; img.className = 'w-full h-28 object-cover rounded'; grid.appendChild(img);
        });
      }).catch(console.error);
    }

    function loadDatabaseStats() { fetch('/api/database-stats').then(r => r.json()).then(data => setText('oldest-data', data?.oldest_date || '-')).catch(console.error); }

    // Actions
    function deleteOldData() {
      const days = parseInt(document.getElementById('retention-period').value || '7', 10);
      const ok = confirm(currentLang === 'th' ? `ลบข้อมูลย้อนหลัง ${days} วันหรือไม่?` : `Delete data older than ${days} days?`);
      if (!ok) return;
      fetch('/api/delete-data', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ days }) })
        .then(r => r.json()).then(() => loadDatabaseStats()).catch(() => alert('Failed'));
    }

    function exportData() { const ok = confirm(currentLang === 'th' ? 'ต้องการส่งออกข้อมูลทั้งหมดหรือไม่?' : 'Export all data?'); if (ok) window.open('/api/export-data', '_blank'); }

    // Chat
    function sendMessage() {
      const input = document.getElementById('chat-input'); const msg = (input?.value || '').trim(); if (!msg) return;
      addChatMessage(msg, 'user'); input.value = ''; addTyping();
      fetch('/api/chat', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ message: msg, lang: currentLang }) })
        .then(r => r.json()).then(d => { removeTyping(); addChatMessage(d?.response || 'No response', 'bot'); })
        .catch(() => { removeTyping(); addChatMessage('Connection error', 'bot'); });
    }

    function addChatMessage(text, who) {
      const box = document.getElementById('chat-messages'); if (!box) return;
      const row = document.createElement('div'); row.className = `flex ${who === 'user' ? 'justify-end' : 'justify-start'}`;
      row.innerHTML = `<div class=\"max-w-[80%] p-2 rounded ${who === 'user' ? 'bg-neon-blue/80 text-black' : 'bg-white/10 border border-white/10'}\">${escapeHtml(text)}</div>`;
      box.appendChild(row); box.scrollTop = box.scrollHeight;
    }

    function addTyping() { addChatMessage('...', 'bot'); }
    function removeTyping() { /* simplified */ }

    <!-- ===== EXTERNAL JAVASCRIPT ===== -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
