<!DOCTYPE html>
<html lang="th" id="app-html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-th="ระบบติดตาม AI นกนางแอ่น - ULTIMATE EDITION" data-en="AI Bird Tracking System - ULTIMATE EDITION">ระบบติดตาม AI นกนางแอ่น - ULTIMATE EDITION</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'neon-blue': '#00D4FF',
                        'neon-purple': '#8B5CF6',
                        'neon-pink': '#F472B6',
                        'cyber-dark': '#0F0F23',
                        'cyber-light': '#1A1A40',
                        'ai-primary': '#4338CA',
                        'ai-secondary': '#7C3AED',
                        'ai-accent': '#06B6D4',
                        'ai-success': '#10B981',
                        'ai-warning': '#F59E0B',
                        'ai-error': '#EF4444',
                    },
                    fontFamily: {
                        'kanit': ['Kanit', 'sans-serif'],
                        'orbitron': ['Orbitron', 'monospace'],
                    },
                    animation: {
                        'cyber-pulse': 'cyberPulse 2s ease-in-out infinite alternate',
                        'neon-glow': 'neonGlow 3s ease-in-out infinite alternate',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'fade-in': 'fadeIn 0.8s ease-out',
                        'float': 'float 6s ease-in-out infinite',
                        'matrix': 'matrix 20s linear infinite',
                    },
                    backdropBlur: {
                        'xs': '2px',
                    }
                }
            }
        }
    </script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200;300;400;500;600;700;800&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <style>
        :root {
            --cyber-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --neon-gradient: linear-gradient(135deg, #00D4FF 0%, #8B5CF6 50%, #F472B6 100%);
            --ai-gradient: linear-gradient(135deg, #4338CA 0%, #7C3AED 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-cyber: 0 0 30px rgba(0, 212, 255, 0.3);
            --shadow-neon: 0 0 40px rgba(139, 92, 246, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #0F0F23 0%, #1A1A40 50%, #2D1B69 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Animated Background */
        .cyber-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(244, 114, 182, 0.1) 0%, transparent 50%);
            z-index: -1;
            animation: float 8s ease-in-out infinite;
        }

        /* Glass Morphism */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        /* Neon Effects */
        .neon-text {
            text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
        }

        .neon-border {
            border: 2px solid transparent;
            background: linear-gradient(var(--cyber-gradient)) border-box;
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }

        .cyber-btn {
            background: var(--ai-gradient);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .cyber-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-neon);
        }

        .cyber-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .cyber-btn:hover::before {
            left: 100%;
        }

        /* Video Container */
        .video-cyber {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-cyber);
            background: linear-gradient(45deg, #000 0%, #1a1a1a 100%);
        }

        .video-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        /* Counter Cards */
        .counter-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .counter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--neon-gradient);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }

        .counter-card:hover::before {
            opacity: 0.1;
        }

        .counter-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-neon);
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--glass-border);
        }

        /* Anomaly Cards */
        .anomaly-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
        }

        .anomaly-card:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow-cyber);
        }

        /* Chatbot */
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 400px;
            max-height: 600px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-cyber);
        }

        .chat-collapsed {
            max-height: 70px;
        }

        /* Status Indicators */
        .status-online {
            width: 12px;
            height: 12px;
            background: #10B981;
            border-radius: 50%;
            animation: cyber-pulse 2s infinite;
            box-shadow: 0 0 10px #10B981;
        }

        /* Data Management */
        .data-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .data-card:hover {
            border-color: var(--neon-blue);
            box-shadow: var(--shadow-cyber);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .chat-container {
                width: calc(100vw - 40px);
                right: 20px;
            }
            
            .video-overlay {
                padding: 20px;
            }
        }

        /* Animations */
        @keyframes cyberPulse {
            0% { box-shadow: 0 0 5px currentColor; }
            100% { box-shadow: 0 0 20px currentColor, 0 0 30px currentColor; }
        }

        @keyframes neonGlow {
            0% { text-shadow: 0 0 5px currentColor; }
            100% { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        /* Loading Animation */
        .loading-dots {
            display: inline-block;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
    </style>
</head>

<body class="min-h-screen relative">
    <!-- Animated Background -->
    <div class="cyber-bg"></div>

    <!-- Header -->
    <header class="glass fixed top-0 left-0 right-0 z-50">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <!-- Logo & Title -->
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-neon-blue to-neon-purple flex items-center justify-center">
                        <i class="fas fa-dove text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold neon-text text-neon-blue font-orbitron" 
                            data-th="ระบบติดตาม AI นกนางแอ่น" 
                            data-en="AI Bird Tracking System">
                            ระบบติดตาม AI นกนางแอ่น
                        </h1>
                        <p class="text-sm text-gray-300 font-kanit" 
                           data-th="ULTIMATE EDITION - ระบบอัจฉริยะ" 
                           data-en="ULTIMATE EDITION - Intelligent System">
                           ULTIMATE EDITION - ระบบอัจฉริยะ
                        </p>
                    </div>
                </div>
                
                <!-- Status & Controls -->
                <div class="flex items-center space-x-6">
                    <!-- AI Status -->
                    <div class="hidden md:flex items-center space-x-3">
                        <div class="status-online"></div>
                        <span class="text-sm text-neon-blue font-orbitron" 
                              data-th="AI ออนไลน์" 
                              data-en="AI Online">
                              AI ออนไลน์
                        </span>
                        <span class="text-xs text-gray-400" id="current-time"></span>
                    </div>
                    
                    <!-- Language Toggle -->
                    <button id="lang-toggle" class="cyber-btn px-4 py-2">
                        <i class="fas fa-language mr-2"></i>
                        <span data-th="ไทย" data-en="EN">ไทย</span>
                    </button>
                    
                    <!-- Theme Toggle -->
                    <button id="theme-toggle" class="cyber-btn px-4 py-2">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="pt-24 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">
            
            <!-- 1. Video Stream Section -->
            <section class="animate-fade-in">
                <div class="video-cyber relative">
                    <img id="video-stream" 
                         src="/video_feed" 
                         alt="Live Stream" 
                         class="w-full h-96 md:h-[500px] object-cover">
                    
                    <!-- Video Overlay with Bird Counter -->
                    <div class="video-overlay">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- Birds In -->
                            <div class="counter-card bg-gradient-to-br from-neon-blue/20 to-transparent">
                                <div class="text-neon-blue text-3xl mb-2">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                                <div class="text-4xl font-bold font-orbitron neon-text text-neon-blue" id="birds-in">0</div>
                                <div class="text-sm font-kanit opacity-80" 
                                     data-th="นกเข้า" 
                                     data-en="Birds In">
                                     นกเข้า
                                </div>
                            </div>
                            
                            <!-- Birds Out -->
                            <div class="counter-card bg-gradient-to-br from-neon-purple/20 to-transparent">
                                <div class="text-neon-purple text-3xl mb-2">
                                    <i class="fas fa-arrow-left"></i>
                                </div>
                                <div class="text-4xl font-bold font-orbitron neon-text text-neon-purple" id="birds-out">0</div>
                                <div class="text-sm font-kanit opacity-80" 
                                     data-th="นกออก" 
                                     data-en="Birds Out">
                                     นกออก
                                </div>
                            </div>
                            
                            <!-- Birds Remaining -->
                            <div class="counter-card bg-gradient-to-br from-neon-pink/20 to-transparent">
                                <div class="text-neon-pink text-3xl mb-2">
                                    <i class="fas fa-home"></i>
                                </div>
                                <div class="text-4xl font-bold font-orbitron neon-text text-neon-pink" id="birds-remaining">0</div>
                                <div class="text-sm font-kanit opacity-80" 
                                     data-th="นกในรัง" 
                                     data-en="In Nest">
                                     นกในรัง
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Live Indicator -->
                    <div class="absolute top-4 left-4 flex items-center space-x-2 glass rounded-full px-4 py-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-ping"></div>
                        <span class="text-sm font-kanit" 
                              data-th="ถ่ายทอดสด" 
                              data-en="LIVE">
                              ถ่ายทอดสด
                        </span>
                    </div>
                </div>
            </section>

            <!-- 2. Analytics & Charts Section -->
            <section class="animate-slide-up">
                <h2 class="text-2xl font-bold text-neon-blue mb-6 flex items-center font-orbitron">
                    <i class="fas fa-chart-line mr-3 text-neon-purple"></i>
                    <span data-th="การวิเคราะห์ข้อมูล AI" data-en="AI Data Analytics">การวิเคราะห์ข้อมูล AI</span>
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Real-time Chart -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4 text-neon-blue font-kanit" 
                            data-th="กราฟแบบเรียลไทม์" 
                            data-en="Real-time Chart">
                            กราฟแบบเรียลไทม์
                        </h3>
                        <canvas id="realtime-chart"></canvas>
                    </div>
                    
                    <!-- Statistics Cards -->
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Today Stats -->
                        <div class="glass-card rounded-xl p-6 text-center">
                            <div class="text-neon-blue text-2xl mb-2">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div class="text-3xl font-bold font-orbitron text-neon-blue" id="today-count">0</div>
                            <div class="text-sm text-gray-300 font-kanit" 
                                 data-th="วันนี้" 
                                 data-en="Today">
                                 วันนี้
                            </div>
                        </div>
                        
                        <!-- Week Stats -->
                        <div class="glass-card rounded-xl p-6 text-center">
                            <div class="text-neon-purple text-2xl mb-2">
                                <i class="fas fa-calendar-week"></i>
                            </div>
                            <div class="text-3xl font-bold font-orbitron text-neon-purple" id="week-count">0</div>
                            <div class="text-sm text-gray-300 font-kanit" 
                                 data-th="สัปดาห์นี้" 
                                 data-en="This Week">
                                 สัปดาห์นี้
                            </div>
                        </div>
                        
                        <!-- Month Stats -->
                        <div class="glass-card rounded-xl p-6 text-center">
                            <div class="text-neon-pink text-2xl mb-2">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="text-3xl font-bold font-orbitron text-neon-pink" id="month-count">0</div>
                            <div class="text-sm text-gray-300 font-kanit" 
                                 data-th="เดือนนี้" 
                                 data-en="This Month">
                                 เดือนนี้
                            </div>
                        </div>
                        
                        <!-- Accuracy -->
                        <div class="glass-card rounded-xl p-6 text-center">
                            <div class="text-green-400 text-2xl mb-2">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="text-3xl font-bold font-orbitron text-green-400" id="accuracy">98.5%</div>
                            <div class="text-sm text-gray-300 font-kanit" 
                                 data-th="ความแม่นยำ" 
                                 data-en="Accuracy">
                                 ความแม่นยำ
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Hourly Chart -->
                <div class="chart-container mt-6">
                    <h3 class="text-lg font-semibold mb-4 text-neon-blue font-kanit" 
                        data-th="กราฟรายชั่วโมง (24 ชม.)" 
                        data-en="Hourly Chart (24h)">
                        กราฟรายชั่วโมง (24 ชม.)
                    </h3>
                    <canvas id="hourly-chart"></canvas>
                </div>
            </section>

            <!-- 3. Anomaly Detection Section -->
            <section class="animate-slide-up">
                <h2 class="text-2xl font-bold text-neon-pink mb-6 flex items-center font-orbitron">
                    <i class="fas fa-exclamation-triangle mr-3 text-yellow-400"></i>
                    <span data-th="ระบบตรวจจับสิ่งแปลกปลอม" data-en="Anomaly Detection System">ระบบตรวจจับสิ่งแปลกปลอม</span>
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Latest Alerts -->
                    <div class="lg:col-span-2">
                        <div class="glass-card rounded-xl p-6">
                            <h3 class="text-lg font-semibold mb-4 text-neon-blue font-kanit" 
                                data-th="การแจ้งเตือนล่าสุด" 
                                data-en="Latest Alerts">
                                การแจ้งเตือนล่าสุด
                            </h3>
                            <div id="alerts-container" class="space-y-3">
                                <!-- Alerts will be loaded here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Detection Stats -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 text-neon-purple font-kanit" 
                            data-th="สถิติการตรวจจับ" 
                            data-en="Detection Stats">
                            สถิติการตรวจจับ
                        </h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300 font-kanit" 
                                      data-th="คนแปลกหน้า" 
                                      data-en="Strangers">
                                      คนแปลกหน้า
                                </span>
                                <span class="text-neon-blue font-orbitron" id="stranger-count">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300 font-kanit" 
                                      data-th="สัตว์อื่น" 
                                      data-en="Other Animals">
                                      สัตว์อื่น
                                </span>
                                <span class="text-neon-purple font-orbitron" id="animal-count">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300 font-kanit" 
                                      data-th="การเคลื่อนไหวผิดปกติ" 
                                      data-en="Unusual Movement">
                                      การเคลื่อนไหวผิดปกติ
                                </span>
                                <span class="text-neon-pink font-orbitron" id="movement-count">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Anomaly Gallery -->
                <div class="glass-card rounded-xl p-6 mt-6">
                    <h3 class="text-lg font-semibold mb-4 text-neon-blue font-kanit" 
                        data-th="ภาพสิ่งแปลกปลอมล่าสุด" 
                        data-en="Recent Anomaly Images">
                        ภาพสิ่งแปลกปลอมล่าสุด
                    </h3>
                    <div id="anomaly-gallery" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <!-- Gallery will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- 4. AI Chatbot (Always visible at bottom right) -->
            <!-- This will be positioned fixed -->

            <!-- 5. System Information (Minimal) -->
            <section class="animate-slide-up">
                <h2 class="text-xl font-bold text-gray-300 mb-4 flex items-center font-orbitron">
                    <i class="fas fa-microchip mr-3 text-blue-400"></i>
                    <span data-th="ข้อมูลระบบ" data-en="System Info">ข้อมูลระบบ</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="glass-card rounded-xl p-4 text-center">
                        <div class="text-blue-400 text-lg mb-2">
                            <i class="fas fa-server"></i>
                        </div>
                        <div class="text-sm text-gray-300 font-kanit" 
                             data-th="สถานะเซิร์ฟเวอร์" 
                             data-en="Server Status">
                             สถานะเซิร์ฟเวอร์
                        </div>
                        <div class="text-green-400 font-orbitron" 
                             data-th="ปกติ" 
                             data-en="Normal">
                             ปกติ
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-xl p-4 text-center">
                        <div class="text-green-400 text-lg mb-2">
                            <i class="fas fa-memory"></i>
                        </div>
                        <div class="text-sm text-gray-300 font-kanit" 
                             data-th="การใช้หน่วยความจำ" 
                             data-en="Memory Usage">
                             การใช้หน่วยความจำ
                        </div>
                        <div class="text-neon-blue font-orbitron" id="memory-usage">65%</div>
                    </div>
                    
                    <div class="glass-card rounded-xl p-4 text-center">
                        <div class="text-yellow-400 text-lg mb-2">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="text-sm text-gray-300 font-kanit" 
                             data-th="ขนาดฐานข้อมูล" 
                             data-en="Database Size">
                             ขนาดฐานข้อมูล
                        </div>
                        <div class="text-neon-purple font-orbitron" id="db-size">2.3 GB</div>
                    </div>
                </div>
            </section>

            <!-- 6. Data Management Section -->
            <section class="animate-slide-up">
                <h2 class="text-2xl font-bold text-neon-blue mb-6 flex items-center font-orbitron">
                    <i class="fas fa-trash-alt mr-3 text-red-400"></i>
                    <span data-th="จัดการข้อมูล" data-en="Data Management">จัดการข้อมูล</span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Data Retention Settings -->
                    <div class="data-card">
                        <h3 class="text-lg font-semibold mb-4 text-neon-purple font-kanit" 
                            data-th="ตั้งค่าการเก็บข้อมูล" 
                            data-en="Data Retention Settings">
                            ตั้งค่าการเก็บข้อมูล
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-300 mb-2 font-kanit" 
                                       data-th="ลบข้อมูลเก่า" 
                                       data-en="Delete Old Data">
                                       ลบข้อมูลเก่า
                                </label>
                                <select id="retention-period" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white font-kanit">
                                    <option value="7" data-th="7 วันย้อนหลัง" data-en="7 days ago">7 วันย้อนหลัง</option>
                                    <option value="15" data-th="15 วันย้อนหลัง" data-en="15 days ago">15 วันย้อนหลัง</option>
                                    <option value="30" data-th="30 วันย้อนหลัง" data-en="30 days ago">30 วันย้อนหลัง</option>
                                </select>
                            </div>
                            <button onclick="deleteOldData()" class="cyber-btn w-full bg-red-600 hover:bg-red-700">
                                <i class="fas fa-trash mr-2"></i>
                                <span data-th="ลบข้อมูลเก่า" data-en="Delete Old Data">ลบข้อมูลเก่า</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Current Data Status -->
                    <div class="data-card">
                        <h3 class="text-lg font-semibold mb-4 text-neon-blue font-kanit" 
                            data-th="สถานะข้อมูลปัจจุบัน" 
                            data-en="Current Data Status">
                            สถานะข้อมูลปัจจุบัน
                        </h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-300 font-kanit" 
                                      data-th="รายการทั้งหมด" 
                                      data-en="Total Records">
                                      รายการทั้งหมด
                                </span>
                                <span class="text-neon-blue font-orbitron" id="total-records">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300 font-kanit" 
                                      data-th="ข้อมูลเก่าสุด" 
                                      data-en="Oldest Data">
                                      ข้อมูลเก่าสุด
                                </span>
                                <span class="text-neon-purple font-orbitron" id="oldest-data">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300 font-kanit" 
                                      data-th="อายุข้อมูลสูงสุด" 
                                      data-en="Max Data Age">
                                      อายุข้อมูลสูงสุด
                                </span>
                                <span class="text-yellow-400 font-orbitron">3-4 เดือน</span>
                            </div>
                        </div>
                        
                        <div class="mt-4 pt-4 border-t border-gray-600">
                            <button onclick="exportData()" class="cyber-btn w-full bg-blue-600 hover:bg-blue-700">
                                <i class="fas fa-download mr-2"></i>
                                <span data-th="ส่งออกข้อมูล" data-en="Export Data">ส่งออกข้อมูล</span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- AI Chatbot (Fixed Position) -->
    <div id="ai-chatbot" class="chat-container chat-collapsed">
        <!-- Chat Header -->
        <div class="bg-gradient-to-r from-neon-blue to-neon-purple p-4 rounded-t-20 cursor-pointer" onclick="toggleChat()">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-robot text-white"></i>
                    </div>
                    <div>
                        <h4 class="text-white font-semibold font-kanit" 
                            data-th="AI ผู้ช่วย" 
                            data-en="AI Assistant">
                            AI ผู้ช่วย
                        </h4>
                        <p class="text-white/80 text-xs font-kanit" 
                           data-th="พร้อมให้บริการ 24/7" 
                           data-en="Available 24/7">
                           พร้อมให้บริการ 24/7
                        </p>
                    </div>
                </div>
                <div class="status-online"></div>
            </div>
        </div>
        
        <!-- Chat Messages -->
        <div id="chat-messages" class="h-80 overflow-y-auto p-4 space-y-3">
            <div class="flex space-x-2">
                <div class="w-8 h-8 bg-gradient-to-r from-neon-blue to-neon-purple rounded-lg flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-robot text-white text-xs"></i>
                </div>
                <div class="glass rounded-xl p-3 max-w-xs">
                    <p class="text-sm text-white font-kanit" 
                       data-th="สวัสดีครับ! ผมคือ AI ผู้ช่วยของระบบติดตาม นกนางแอ่น มีอะไรให้ช่วยไหมครับ?" 
                       data-en="Hello! I'm the AI assistant for the bird tracking system. How can I help you?">
                       สวัสดีครับ! ผมคือ AI ผู้ช่วยของระบบติดตาม นกนางแอ่น มีอะไรให้ช่วยไหมครับ?
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Chat Input -->
        <div class="p-4 border-t border-gray-600">
            <div class="flex space-x-2">
                <input type="text" 
                       id="chat-input" 
                       class="flex-1 bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white font-kanit" 
                       placeholder="พิมพ์ข้อความของคุณ..."
                       data-th-placeholder="พิมพ์ข้อความของคุณ..." 
                       data-en-placeholder="Type your message...">
                <button onclick="sendMessage()" class="cyber-btn px-4 py-2">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Global Variables
        let currentLang = 'th';
        let isDarkMode = false;
        let isChatExpanded = false;
        let realtimeChart, hourlyChart;

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            updateTime();
            setInterval(updateTime, 1000);
            setInterval(updateRealTimeData, 5000);
        });

        function initializeApp() {
            setupEventListeners();
            initializeCharts();
            loadInitialData();
        }

        function setupEventListeners() {
            document.getElementById('lang-toggle').addEventListener('click', toggleLanguage);
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            
            document.getElementById('chat-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('th-TH');
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        function toggleLanguage() {
            currentLang = currentLang === 'th' ? 'en' : 'th';
            updateLanguageElements();
            
            // Update toggle button text
            const toggleBtn = document.querySelector('#lang-toggle span');
            toggleBtn.textContent = currentLang === 'th' ? 'ไทย' : 'EN';
        }

        function updateLanguageElements() {
            const elements = document.querySelectorAll('[data-th][data-en]');
            elements.forEach(element => {
                const text = currentLang === 'th' ? element.getAttribute('data-th') : element.getAttribute('data-en');
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = text;
                } else {
                    element.textContent = text;
                }
            });
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark', isDarkMode);
            
            const themeIcon = document.querySelector('#theme-toggle i');
            themeIcon.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
        }

        function toggleChat() {
            isChatExpanded = !isChatExpanded;
            const chatbot = document.getElementById('ai-chatbot');
            chatbot.classList.toggle('chat-collapsed', !isChatExpanded);
        }

        function updateRealTimeData() {
            // Update bird counters
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('birds-in').textContent = data.birds_in || 0;
                    document.getElementById('birds-out').textContent = data.birds_out || 0;
                    document.getElementById('birds-remaining').textContent = (data.birds_in || 0) - (data.birds_out || 0);
                })
                .catch(error => console.error('Error updating data:', error));

            // Update statistics
            fetch('/api/statistics')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('today-count').textContent = data.today || 0;
                    document.getElementById('week-count').textContent = data.week || 0;
                    document.getElementById('month-count').textContent = data.month || 0;
                    
                    // Update charts
                    if (data.hourly && hourlyChart) {
                        updateHourlyChart(data.hourly);
                    }
                })
                .catch(error => console.error('Error updating statistics:', error));

            // Update anomaly detection
            loadAnomalyData();
        }

        function initializeCharts() {
            // Real-time Chart
            const realtimeCtx = document.getElementById('realtime-chart').getContext('2d');
            realtimeChart = new Chart(realtimeCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Birds Detected',
                        data: [],
                        borderColor: '#00D4FF',
                        backgroundColor: 'rgba(0, 212, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: 'white'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });

            // Hourly Chart
            const hourlyCtx = document.getElementById('hourly-chart').getContext('2d');
            hourlyChart = new Chart(hourlyCtx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [{
                        label: 'Hourly Detection',
                        data: new Array(24).fill(0),
                        backgroundColor: 'rgba(139, 92, 246, 0.6)',
                        borderColor: '#8B5CF6',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: 'white'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function updateHourlyChart(hourlyData) {
            if (hourlyChart && hourlyData) {
                hourlyChart.data.datasets[0].data = hourlyData;
                hourlyChart.update();
            }
        }

        function loadInitialData() {
            updateRealTimeData();
            loadDatabaseStats();
        }

        function loadAnomalyData() {
            // Load alerts
            fetch('/api/notifications')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('alerts-container');
                    container.innerHTML = '';
                    
                    data.slice(0, 5).forEach(alert => {
                        const alertDiv = document.createElement('div');
                        alertDiv.className = 'anomaly-card flex items-center space-x-3';
                        alertDiv.innerHTML = `
                            <div class="w-3 h-3 bg-red-500 rounded-full animate-ping flex-shrink-0"></div>
                            <div class="flex-1">
                                <div class="text-sm font-semibold text-white">${alert.message}</div>
                                <div class="text-xs text-gray-400">${alert.timestamp}</div>
                            </div>
                        `;
                        container.appendChild(alertDiv);
                    });
                })
                .catch(error => console.error('Error loading alerts:', error));

            // Load anomaly images
            fetch('/api/anomaly-images')
                .then(response => response.json())
                .then(data => {
                    const gallery = document.getElementById('anomaly-gallery');
                    gallery.innerHTML = '';
                    
                    data.slice(0, 6).forEach(image => {
                        const imgDiv = document.createElement('div');
                        imgDiv.className = 'anomaly-card aspect-square';
                        imgDiv.innerHTML = `
                            <img src="/static/anomaly_images/${image}" 
                                 alt="Anomaly" 
                                 class="w-full h-full object-cover rounded-lg">
                        `;
                        gallery.appendChild(imgDiv);
                    });
                })
                .catch(error => console.error('Error loading anomaly images:', error));
        }

        function loadDatabaseStats() {
            fetch('/api/database-stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('total-records').textContent = data.total_records || 0;
                    document.getElementById('oldest-data').textContent = data.oldest_date || '-';
                })
                .catch(error => console.error('Error loading database stats:', error));
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addChatMessage(message, 'user');
            input.value = '';
            
            // Send to AI
            fetch('/api/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({message: message})
            })
            .then(response => response.json())
            .then(data => {
                addChatMessage(data.response, 'bot');
            })
            .catch(error => {
                console.error('Error sending message:', error);
                addChatMessage('ขออภัย เกิดข้อผิดพลาดในการตอบกลับ', 'bot');
            });
        }

        function addChatMessage(message, sender) {
            const container = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex space-x-2';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="flex-1"></div>
                    <div class="bg-gradient-to-r from-neon-blue to-neon-purple rounded-xl p-3 max-w-xs">
                        <p class="text-sm text-white">${message}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 bg-gradient-to-r from-neon-blue to-neon-purple rounded-lg flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-robot text-white text-xs"></i>
                    </div>
                    <div class="glass rounded-xl p-3 max-w-xs">
                        <p class="text-sm text-white">${message}</p>
                    </div>
                `;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function deleteOldData() {
            const period = document.getElementById('retention-period').value;
            const confirmText = currentLang === 'th' ? 
                `คุณแน่ใจหรือไม่ที่จะลบข้อมูล ${period} วันย้อนหลัง?` : 
                `Are you sure you want to delete data from ${period} days ago?`;
            
            if (confirm(confirmText)) {
                fetch('/api/delete-data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({days: parseInt(period)})
                })
                .then(response => response.json())
                .then(data => {
                    const successText = currentLang === 'th' ? 
                        'ลบข้อมูลเก่าเรียบร้อยแล้ว' : 
                        'Old data deleted successfully';
                    alert(successText);
                    loadDatabaseStats();
                })
                .catch(error => {
                    console.error('Error deleting data:', error);
                    const errorText = currentLang === 'th' ? 
                        'เกิดข้อผิดพลาดในการลบข้อมูล' : 
                        'Error deleting data';
                    alert(errorText);
                });
            }
        }

        function exportData() {
            const confirmText = currentLang === 'th' ? 
                'คุณต้องการส่งออกข้อมูลทั้งหมดหรือไม่?' : 
                'Do you want to export all data?';
            
            if (confirm(confirmText)) {
                window.open('/api/export-data', '_blank');
            }
        }

        // Error handling for video stream
        document.getElementById('video-stream').onerror = function() {
            this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjUwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMTExIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJLYW5pdCIgZm9udC1zaXplPSIzMCIgZmlsbD0iIzAwRDRGRiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPvCfk7kgVmlkZW8gT2ZmbGluZSDwn5O5PC90ZXh0Pjx0ZXh0IHg9IjUwJSIgeT0iNjAlIiBmb250LWZhbWlseT0iS2FuaXQiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM4Qjk3QTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7guJDguYjguLLguKLguJfguK3guJTguKrguJQ8L3RleHQ+PC9zdmc+';
        };

        // Auto-refresh data every 5 seconds
        setInterval(updateRealTimeData, 5000);
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                toggleChat();
                document.getElementById('chat-input').focus();
            }
        });
    </script>
</body>
</html>
